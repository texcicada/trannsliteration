\newcommand\avtag{{\tiny [Avestan]\par}}

\ExplSyntaxOn

%\transrev: common code

%-----   Unicode codepoint
\newcommand\doavtransuc{%
%
\regex_replace_all:nnN { U\+10B00 } { \cB\{ \c{avfont}ğ¬€ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B01 } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B02 } { \cB\{ \c{avfont}ğ¬‚ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B03 } { \cB\{ \c{avfont}ğ¬ƒ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B04 } { \cB\{ \c{avfont}ğ¬„ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B05 } { \cB\{ \c{avfont}ğ¬… \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B06 } { \cB\{ \c{avfont}ğ¬† \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B07 } { \cB\{ \c{avfont}ğ¬‡ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B08 } { \cB\{ \c{avfont}ğ¬ˆ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B09 } { \cB\{ \c{avfont}ğ¬‰ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B0A } { \cB\{ \c{avfont}ğ¬Š \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B0B } { \cB\{ \c{avfont}ğ¬‹ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B0C } { \cB\{ \c{avfont}ğ¬Œ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B0D } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B0E } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B0F } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B10 } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B11 } { \cB\{ \c{avfont}ğ¬‘ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B12 } { \cB\{ \c{avfont}ğ¬’ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B13 } { \cB\{ \c{avfont}ğ¬“ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B14 } { \cB\{ \c{avfont}ğ¬” \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B15 } { \cB\{ \c{avfont}ğ¬• \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B16 } { \cB\{ \c{avfont}ğ¬– \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B17 } { \cB\{ \c{avfont}ğ¬— \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B18 } { \cB\{ \c{avfont}ğ¬˜ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B19 } { \cB\{ \c{avfont}ğ¬™ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B1A } { \cB\{ \c{avfont}ğ¬š \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B1B } { \cB\{ \c{avfont}ğ¬› \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B1C } { \cB\{ \c{avfont}ğ¬œ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B1D } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B1E } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B1F } { \cB\{ \c{avfont}ğ¬Ÿ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B20 } { \cB\{ \c{avfont}ğ¬  \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B21 } { \cB\{ \c{avfont}ğ¬¡ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B22 } { \cB\{ \c{avfont}ğ¬¢ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B23 } { \cB\{ \c{avfont}ğ¬£ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B24 } { \cB\{ \c{avfont}ğ¬¤ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B25 } { \cB\{ \c{avfont}ğ¬¥ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B26 } { \cB\{ \c{avfont}ğ¬¦ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B27 } { \cB\{ \c{avfont}ğ¬§ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B28 } { \cB\{ \c{avfont}ğ¬¨ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B29 } { \cB\{ \c{avfont}ğ¬© \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B2A } { \cB\{ \c{avfont}ğ¬ª \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B2B } { \cB\{ \c{avfont}ğ¬« \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B2C } { \cB\{ \c{avfont}ğ¬¬ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B2D } { \cB\{ \c{avfont}ğ¬­ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B2E } { \cB\{ \c{avfont}ğ¬® \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B2F } { \cB\{ \c{avfont}ğ¬¯ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B30 } { \cB\{ \c{avfont}ğ¬° \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B31 } { \cB\{ \c{avfont}ğ¬± \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B32 } { \cB\{ \c{avfont}ğ¬² \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B33 } { \cB\{ \c{avfont}ğ¬³ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B34 } { \cB\{ \c{avfont}ğ¬´ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B35 } { \cB\{ \c{avfont}ğ¬µ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B39 } { \cB\{ \c{avfont}ğ¬¹ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B3A } { \cB\{ \c{avfont}ğ¬º \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B3B } { \cB\{ \c{avfont}ğ¬» \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B3C } { \cB\{ \c{avfont}ğ¬¼ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B3D } { \cB\{ \c{avfont}ğ¬½ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B3E } { \cB\{ \c{avfont}ğ¬¾ \cE\}  } \l_myuc_tl
\regex_replace_all:nnN { U\+10B3F } { \cB\{ \c{avfont}ğ¬¿ \cE\}  } \l_myuc_tl
}


%-----   Unicode name
\newcommand\doavtransun{%
%
\regex_replace_all:nnN { abbreviationmark } { \cB\{ \c{avfont}ğ¬¹ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ngye } { \cB\{ \c{avfont}ğ¬£ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ngve } { \cB\{ \c{avfont}ğ¬¤ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { shye } { \cB\{ \c{avfont}ğ¬³ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { sshe } { \cB\{ \c{avfont}ğ¬´ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { aao } { \cB\{ \c{avfont}ğ¬ƒ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { aan } { \cB\{ \c{avfont}ğ¬… \cE\}  } \l_myun_tl
\regex_replace_all:nnN { aee } { \cB\{ \c{avfont}ğ¬‡ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { xye } { \cB\{ \c{avfont}ğ¬’ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { xve } { \cB\{ \c{avfont}ğ¬“ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { gge } { \cB\{ \c{avfont}ğ¬• \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ghe } { \cB\{ \c{avfont}ğ¬– \cE\}  } \l_myun_tl
\regex_replace_all:nnN { the } { \cB\{ \c{avfont}ğ¬š \cE\}  } \l_myun_tl
\regex_replace_all:nnN { dhe } { \cB\{ \c{avfont}ğ¬œ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { tte } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { bhe } { \cB\{ \c{avfont}ğ¬¡ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { nge } { \cB\{ \c{avfont}ğ¬¢ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { nye } { \cB\{ \c{avfont}ğ¬¦ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { nne } { \cB\{ \c{avfont}ğ¬§ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { hme } { \cB\{ \c{avfont}ğ¬© \cE\}  } \l_myun_tl
\regex_replace_all:nnN { yye } { \cB\{ \c{avfont}ğ¬ª \cE\}  } \l_myun_tl
\regex_replace_all:nnN { she } { \cB\{ \c{avfont}ğ¬± \cE\}  } \l_myun_tl
\regex_replace_all:nnN { zhe } { \cB\{ \c{avfont}ğ¬² \cE\}  } \l_myun_tl
\regex_replace_all:nnN { aa } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ao } { \cB\{ \c{avfont}ğ¬‚ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { an } { \cB\{ \c{avfont}ğ¬„ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ae } { \cB\{ \c{avfont}ğ¬† \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ee } { \cB\{ \c{avfont}ğ¬‰ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { oo } { \cB\{ \c{avfont}ğ¬‹ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ii } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { uu } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ke } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { xe } { \cB\{ \c{avfont}ğ¬‘ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ge } { \cB\{ \c{avfont}ğ¬” \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ce } { \cB\{ \c{avfont}ğ¬— \cE\}  } \l_myun_tl
\regex_replace_all:nnN { je } { \cB\{ \c{avfont}ğ¬˜ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { te } { \cB\{ \c{avfont}ğ¬™ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { de } { \cB\{ \c{avfont}ğ¬› \cE\}  } \l_myun_tl
\regex_replace_all:nnN { pe } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { fe } { \cB\{ \c{avfont}ğ¬Ÿ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { be } { \cB\{ \c{avfont}ğ¬  \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ne } { \cB\{ \c{avfont}ğ¬¥ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { me } { \cB\{ \c{avfont}ğ¬¨ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ye } { \cB\{ \c{avfont}ğ¬« \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ve } { \cB\{ \c{avfont}ğ¬¬ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { re } { \cB\{ \c{avfont}ğ¬­ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { le } { \cB\{ \c{avfont}ğ¬® \cE\}  } \l_myun_tl
\regex_replace_all:nnN { se } { \cB\{ \c{avfont}ğ¬¯ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { ze } { \cB\{ \c{avfont}ğ¬° \cE\}  } \l_myun_tl
\regex_replace_all:nnN { he } { \cB\{ \c{avfont}ğ¬µ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { p1 } { \cB\{ \c{avfont}ğ¬º \cE\}  } \l_myun_tl
\regex_replace_all:nnN { p2 } { \cB\{ \c{avfont}ğ¬» \cE\}  } \l_myun_tl
\regex_replace_all:nnN { p3 } { \cB\{ \c{avfont}ğ¬¼ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { p4 } { \cB\{ \c{avfont}ğ¬½ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { p5 } { \cB\{ \c{avfont}ğ¬¾ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { p6 } { \cB\{ \c{avfont}ğ¬¿ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { a } { \cB\{ \c{avfont}ğ¬€ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { e } { \cB\{ \c{avfont}ğ¬ˆ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { o } { \cB\{ \c{avfont}ğ¬Š \cE\}  } \l_myun_tl
\regex_replace_all:nnN { i } { \cB\{ \c{avfont}ğ¬Œ \cE\}  } \l_myun_tl
\regex_replace_all:nnN { u } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myun_tl
}

%-----   Typing shortcut
\newcommand\doavtransts{%
%
\regex_replace_all:nnN { ahh } { \cB\{ \c{avfont}ğ¬ƒ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { auu } { \cB\{ \c{avfont}ğ¬… \cE\}  } \l_myts_tl
\regex_replace_all:nnN { ehh } { \cB\{ \c{avfont}ğ¬‡ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { ngj } { \cB\{ \c{avfont}ğ¬£ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { ngw } { \cB\{ \c{avfont}ğ¬¤ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { nny } { \cB\{ \c{avfont}ğ¬§ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { ssh } { \cB\{ \c{avfont}ğ¬³ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { aa } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { ah } { \cB\{ \c{avfont}ğ¬‚ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { au } { \cB\{ \c{avfont}ğ¬„ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { eh } { \cB\{ \c{avfont}ğ¬† \cE\}  } \l_myts_tl
\regex_replace_all:nnN { ee } { \cB\{ \c{avfont}ğ¬‰ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { oo } { \cB\{ \c{avfont}ğ¬‹ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { ii } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { uu } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { xx } { \cB\{ \c{avfont}ğ¬’ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { xv } { \cB\{ \c{avfont}ğ¬“ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { gg } { \cB\{ \c{avfont}ğ¬• \cE\}  } \l_myts_tl
\regex_replace_all:nnN { gh } { \cB\{ \c{avfont}ğ¬– \cE\}  } \l_myts_tl
\regex_replace_all:nnN { th } { \cB\{ \c{avfont}ğ¬š \cE\}  } \l_myts_tl
\regex_replace_all:nnN { dh } { \cB\{ \c{avfont}ğ¬œ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { tt } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { ng } { \cB\{ \c{avfont}ğ¬¢ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { ny } { \cB\{ \c{avfont}ğ¬¦ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { mh } { \cB\{ \c{avfont}ğ¬© \cE\}  } \l_myts_tl
\regex_replace_all:nnN { yy } { \cB\{ \c{avfont}ğ¬ª \cE\}  } \l_myts_tl
\regex_replace_all:nnN { sh } { \cB\{ \c{avfont}ğ¬± \cE\}  } \l_myts_tl
\regex_replace_all:nnN { zh } { \cB\{ \c{avfont}ğ¬² \cE\}  } \l_myts_tl
\regex_replace_all:nnN { ss } { \cB\{ \c{avfont}ğ¬´ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { p1 } { \cB\{ \c{avfont}ğ¬º \cE\}  } \l_myts_tl
\regex_replace_all:nnN { p2 } { \cB\{ \c{avfont}ğ¬» \cE\}  } \l_myts_tl
\regex_replace_all:nnN { p3 } { \cB\{ \c{avfont}ğ¬¼ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { p4 } { \cB\{ \c{avfont}ğ¬½ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { p5 } { \cB\{ \c{avfont}ğ¬¾ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { p6 } { \cB\{ \c{avfont}ğ¬¿ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { a } { \cB\{ \c{avfont}ğ¬€ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { e } { \cB\{ \c{avfont}ğ¬ˆ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { o } { \cB\{ \c{avfont}ğ¬Š \cE\}  } \l_myts_tl
\regex_replace_all:nnN { i } { \cB\{ \c{avfont}ğ¬Œ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { u } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { k } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { x } { \cB\{ \c{avfont}ğ¬‘ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { g } { \cB\{ \c{avfont}ğ¬” \cE\}  } \l_myts_tl
\regex_replace_all:nnN { c } { \cB\{ \c{avfont}ğ¬— \cE\}  } \l_myts_tl
\regex_replace_all:nnN { j } { \cB\{ \c{avfont}ğ¬˜ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { t } { \cB\{ \c{avfont}ğ¬™ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { d } { \cB\{ \c{avfont}ğ¬› \cE\}  } \l_myts_tl
\regex_replace_all:nnN { p } { \cB\{ \c{avfont}ğ¬ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { f } { \cB\{ \c{avfont}ğ¬Ÿ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { b } { \cB\{ \c{avfont}ğ¬  \cE\}  } \l_myts_tl
\regex_replace_all:nnN { w } { \cB\{ \c{avfont}ğ¬¡ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { n } { \cB\{ \c{avfont}ğ¬¥ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { m } { \cB\{ \c{avfont}ğ¬¨ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { y } { \cB\{ \c{avfont}ğ¬« \cE\}  } \l_myts_tl
\regex_replace_all:nnN { v } { \cB\{ \c{avfont}ğ¬¬ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { r } { \cB\{ \c{avfont}ğ¬­ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { l } { \cB\{ \c{avfont}ğ¬® \cE\}  } \l_myts_tl
\regex_replace_all:nnN { s } { \cB\{ \c{avfont}ğ¬¯ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { z } { \cB\{ \c{avfont}ğ¬° \cE\}  } \l_myts_tl
\regex_replace_all:nnN { h } { \cB\{ \c{avfont}ğ¬µ \cE\}  } \l_myts_tl
\regex_replace_all:nnN { ' } { \cB\{ \c{avfont}ğ¬¹ \cE\}  } \l_myts_tl
}


%-----   Scholarly transliteration
\newcommand\doavtranstsst{%
%
\regex_replace_all:nnN { ahh } { ÄÌŠ  } \l_myst_tl
\regex_replace_all:nnN { auu } { Ä…Ì‡  } \l_myst_tl
\regex_replace_all:nnN { ehh } { É™Ì„  } \l_myst_tl
\regex_replace_all:nnN { ngj } { Å‹Ì  } \l_myst_tl
\regex_replace_all:nnN { ngw } { Å‹áµ›  } \l_myst_tl
\regex_replace_all:nnN { nny } { á¹‡  } \l_myst_tl
\regex_replace_all:nnN { ssh } { Å¡Ì  } \l_myst_tl
\regex_replace_all:nnN { aa } { Ä  } \l_myst_tl
\regex_replace_all:nnN { ah } { Ã¥  } \l_myst_tl
\regex_replace_all:nnN { au } { Ä…  } \l_myst_tl
\regex_replace_all:nnN { eh } { É™  } \l_myst_tl
\regex_replace_all:nnN { ee } { Ä“  } \l_myst_tl
\regex_replace_all:nnN { oo } { Å  } \l_myst_tl
\regex_replace_all:nnN { ii } { Ä«  } \l_myst_tl
\regex_replace_all:nnN { uu } { Å«  } \l_myst_tl
\regex_replace_all:nnN { xx } { xÌ  } \l_myst_tl
\regex_replace_all:nnN { xv } { xáµ›  } \l_myst_tl
\regex_replace_all:nnN { gg } { Ä¡  } \l_myst_tl
\regex_replace_all:nnN { gh } { Î³  } \l_myst_tl
\regex_replace_all:nnN { th } { Ï‘  } \l_myst_tl
\regex_replace_all:nnN { dh } { Î´  } \l_myst_tl
\regex_replace_all:nnN { tt } { tÌ°  } \l_myst_tl
\regex_replace_all:nnN { ng } { Å‹  } \l_myst_tl
\regex_replace_all:nnN { ny } { Å„  } \l_myst_tl
\regex_replace_all:nnN { mh } { mÌ¨  } \l_myst_tl
\regex_replace_all:nnN { yy } { áº  } \l_myst_tl
\regex_replace_all:nnN { sh } { Å¡  } \l_myst_tl
\regex_replace_all:nnN { zh } { Å¾  } \l_myst_tl
\regex_replace_all:nnN { ss } { á¹£ÌŒ  } \l_myst_tl
\regex_replace_all:nnN { p1 } { p1  } \l_myst_tl
\regex_replace_all:nnN { p2 } { p2  } \l_myst_tl
\regex_replace_all:nnN { p3 } { p3  } \l_myst_tl
\regex_replace_all:nnN { p4 } { p4  } \l_myst_tl
\regex_replace_all:nnN { p5 } { p5  } \l_myst_tl
\regex_replace_all:nnN { p6 } { p6  } \l_myst_tl
\regex_replace_all:nnN { a } { a  } \l_myst_tl
\regex_replace_all:nnN { e } { e  } \l_myst_tl
\regex_replace_all:nnN { o } { o  } \l_myst_tl
\regex_replace_all:nnN { i } { i  } \l_myst_tl
\regex_replace_all:nnN { u } { u  } \l_myst_tl
\regex_replace_all:nnN { k } { k  } \l_myst_tl
\regex_replace_all:nnN { x } { x  } \l_myst_tl
\regex_replace_all:nnN { g } { g  } \l_myst_tl
\regex_replace_all:nnN { c } { c  } \l_myst_tl
\regex_replace_all:nnN { j } { j  } \l_myst_tl
\regex_replace_all:nnN { t } { t  } \l_myst_tl
\regex_replace_all:nnN { d } { d  } \l_myst_tl
\regex_replace_all:nnN { p } { p  } \l_myst_tl
\regex_replace_all:nnN { f } { f  } \l_myst_tl
\regex_replace_all:nnN { b } { b  } \l_myst_tl
\regex_replace_all:nnN { w } { Î²  } \l_myst_tl
\regex_replace_all:nnN { n } { n  } \l_myst_tl
\regex_replace_all:nnN { m } { m  } \l_myst_tl
\regex_replace_all:nnN { y } { y  } \l_myst_tl
\regex_replace_all:nnN { v } { v  } \l_myst_tl
\regex_replace_all:nnN { r } { r  } \l_myst_tl
\regex_replace_all:nnN { l } { l  } \l_myst_tl
\regex_replace_all:nnN { s } { s  } \l_myst_tl
\regex_replace_all:nnN { z } { z  } \l_myst_tl
\regex_replace_all:nnN { h } { h  } \l_myst_tl
\regex_replace_all:nnN { ' } { '  } \l_myst_tl
}



%-----   Ruby Part 2a
\newcommand\doavtranstsruby{%
\regex_replace_all:nnN {ahh} { èŒ } \l_myy_tl
\regex_replace_all:nnN {auu} { è } \l_myy_tl
\regex_replace_all:nnN {ehh} { è } \l_myy_tl
\regex_replace_all:nnN {ngj} { è¬ } \l_myy_tl
\regex_replace_all:nnN {ngw} { è­ } \l_myy_tl
\regex_replace_all:nnN {nny} { è° } \l_myy_tl
\regex_replace_all:nnN {ssh} { è¼ } \l_myy_tl
\regex_replace_all:nnN {aa} { èŠ } \l_myy_tl
\regex_replace_all:nnN {ah} { è‹ } \l_myy_tl
\regex_replace_all:nnN {au} { è } \l_myy_tl
\regex_replace_all:nnN {eh} { è } \l_myy_tl
\regex_replace_all:nnN {ee} { è’ } \l_myy_tl
\regex_replace_all:nnN {oo} { è” } \l_myy_tl
\regex_replace_all:nnN {ii} { è– } \l_myy_tl
\regex_replace_all:nnN {uu} { è˜ } \l_myy_tl
\regex_replace_all:nnN {xx} { è› } \l_myy_tl
\regex_replace_all:nnN {xv} { èœ } \l_myy_tl
\regex_replace_all:nnN {gg} { è } \l_myy_tl
\regex_replace_all:nnN {gh} { èŸ } \l_myy_tl
\regex_replace_all:nnN {th} { è£ } \l_myy_tl
\regex_replace_all:nnN {dh} { è¥ } \l_myy_tl
\regex_replace_all:nnN {tt} { è¦ } \l_myy_tl
\regex_replace_all:nnN {ng} { è« } \l_myy_tl
\regex_replace_all:nnN {ny} { è¯ } \l_myy_tl
\regex_replace_all:nnN {mh} { è² } \l_myy_tl
\regex_replace_all:nnN {yy} { è³ } \l_myy_tl
\regex_replace_all:nnN {sh} { èº } \l_myy_tl
\regex_replace_all:nnN {zh} { è» } \l_myy_tl
\regex_replace_all:nnN {ss} { è½ } \l_myy_tl
\regex_replace_all:nnN {p1} { è€ } \l_myy_tl
\regex_replace_all:nnN {p2} { è } \l_myy_tl
\regex_replace_all:nnN {p3} { è‚ } \l_myy_tl
\regex_replace_all:nnN {p4} { èƒ } \l_myy_tl
\regex_replace_all:nnN {p5} { è„ } \l_myy_tl
\regex_replace_all:nnN {p6} { è… } \l_myy_tl
\regex_replace_all:nnN {a} { è‰ } \l_myy_tl
\regex_replace_all:nnN {e} { è‘ } \l_myy_tl
\regex_replace_all:nnN {o} { è“ } \l_myy_tl
\regex_replace_all:nnN {i} { è• } \l_myy_tl
\regex_replace_all:nnN {u} { è— } \l_myy_tl
\regex_replace_all:nnN {k} { è™ } \l_myy_tl
\regex_replace_all:nnN {x} { èš } \l_myy_tl
\regex_replace_all:nnN {g} { è } \l_myy_tl
\regex_replace_all:nnN {c} { è  } \l_myy_tl
\regex_replace_all:nnN {j} { è¡ } \l_myy_tl
\regex_replace_all:nnN {t} { è¢ } \l_myy_tl
\regex_replace_all:nnN {d} { è¤ } \l_myy_tl
\regex_replace_all:nnN {p} { è§ } \l_myy_tl
\regex_replace_all:nnN {f} { è¨ } \l_myy_tl
\regex_replace_all:nnN {b} { è© } \l_myy_tl
\regex_replace_all:nnN {w} { èª } \l_myy_tl
\regex_replace_all:nnN {n} { è® } \l_myy_tl
\regex_replace_all:nnN {m} { è± } \l_myy_tl
\regex_replace_all:nnN {y} { è´ } \l_myy_tl
\regex_replace_all:nnN {v} { èµ } \l_myy_tl
\regex_replace_all:nnN {r} { è¶ } \l_myy_tl
\regex_replace_all:nnN {l} { è· } \l_myy_tl
\regex_replace_all:nnN {s} { è¸ } \l_myy_tl
\regex_replace_all:nnN {z} { è¹ } \l_myy_tl
\regex_replace_all:nnN {h} { è¾ } \l_myy_tl
\regex_replace_all:nnN {'} { è¿ } \l_myy_tl
%
		% put into a sequence, splitting by the delimiter		
		\exp_args:Nnno
							\seq_set_split:Nnn 
												\l_my_seq 
												{ } 
												{ \l_myy_tl }

		% reverse the sequence
		\seq_reverse:N 
							\l_my_seq 
							
			% remove the last (now first) (empty) item
%	\seq_pop_left:NNTF 
%					\l_my_seq 
%					\l_myy_tl 
%					{ } 
%					{ }

				% expand the sequence code, storing result in the TL
				\exp_args:Nne
										\tl_set:Nn 
															\l_myy_tl 
															{ \seq_use:Nn \l_my_seq { } }
															
					% now do the regex on the IDs					
\regex_replace_all:nnN {è‰} { \c{tablea}a\c{tableb} \cB\{ \c{avfont}ğ¬€\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {èŠ} { \c{tablea}Ä\c{tableb} \cB\{ \c{avfont}ğ¬\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è‹} { \c{tablea}Ã¥\c{tableb} \cB\{ \c{avfont}ğ¬‚\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {èŒ} { \c{tablea}ÄÌŠ\c{tableb} \cB\{ \c{avfont}ğ¬ƒ\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è} { \c{tablea}Ä…\c{tableb} \cB\{ \c{avfont}ğ¬„\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è} { \c{tablea}Ä…Ì‡\c{tableb} \cB\{ \c{avfont}ğ¬…\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è} { \c{tablea}É™\c{tableb} \cB\{ \c{avfont}ğ¬†\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è} { \c{tablea}É™Ì„\c{tableb} \cB\{ \c{avfont}ğ¬‡\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è‘} { \c{tablea}e\c{tableb} \cB\{ \c{avfont}ğ¬ˆ\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è’} { \c{tablea}Ä“\c{tableb} \cB\{ \c{avfont}ğ¬‰\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è“} { \c{tablea}o\c{tableb} \cB\{ \c{avfont}ğ¬Š\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è”} { \c{tablea}Å\c{tableb} \cB\{ \c{avfont}ğ¬‹\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è•} { \c{tablea}i\c{tableb} \cB\{ \c{avfont}ğ¬Œ\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è–} { \c{tablea}Ä«\c{tableb} \cB\{ \c{avfont}ğ¬\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è—} { \c{tablea}u\c{tableb} \cB\{ \c{avfont}ğ¬\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è˜} { \c{tablea}Å«\c{tableb} \cB\{ \c{avfont}ğ¬\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è™} { \c{tablea}k\c{tableb} \cB\{ \c{avfont}ğ¬\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {èš} { \c{tablea}x\c{tableb} \cB\{ \c{avfont}ğ¬‘\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è›} { \c{tablea}xÌ\c{tableb} \cB\{ \c{avfont}ğ¬’\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {èœ} { \c{tablea}xáµ›\c{tableb} \cB\{ \c{avfont}ğ¬“\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è} { \c{tablea}g\c{tableb} \cB\{ \c{avfont}ğ¬”\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è} { \c{tablea}Ä¡\c{tableb} \cB\{ \c{avfont}ğ¬•\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {èŸ} { \c{tablea}Î³\c{tableb} \cB\{ \c{avfont}ğ¬–\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è } { \c{tablea}c\c{tableb} \cB\{ \c{avfont}ğ¬—\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¡} { \c{tablea}j\c{tableb} \cB\{ \c{avfont}ğ¬˜\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¢} { \c{tablea}t\c{tableb} \cB\{ \c{avfont}ğ¬™\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è£} { \c{tablea}Ï‘\c{tableb} \cB\{ \c{avfont}ğ¬š\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¤} { \c{tablea}d\c{tableb} \cB\{ \c{avfont}ğ¬›\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¥} { \c{tablea}Î´\c{tableb} \cB\{ \c{avfont}ğ¬œ\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¦} { \c{tablea}tÌ°\c{tableb} \cB\{ \c{avfont}ğ¬\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è§} { \c{tablea}p\c{tableb} \cB\{ \c{avfont}ğ¬\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¨} { \c{tablea}f\c{tableb} \cB\{ \c{avfont}ğ¬Ÿ\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è©} { \c{tablea}b\c{tableb} \cB\{ \c{avfont}ğ¬ \cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {èª} { \c{tablea}Î²\c{tableb} \cB\{ \c{avfont}ğ¬¡\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è«} { \c{tablea}Å‹\c{tableb} \cB\{ \c{avfont}ğ¬¢\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¬} { \c{tablea}Å‹Ì\c{tableb} \cB\{ \c{avfont}ğ¬£\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è­} { \c{tablea}Å‹áµ›\c{tableb} \cB\{ \c{avfont}ğ¬¤\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è®} { \c{tablea}n\c{tableb} \cB\{ \c{avfont}ğ¬¥\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¯} { \c{tablea}Å„\c{tableb} \cB\{ \c{avfont}ğ¬¦\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è°} { \c{tablea}á¹‡\c{tableb} \cB\{ \c{avfont}ğ¬§\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è±} { \c{tablea}m\c{tableb} \cB\{ \c{avfont}ğ¬¨\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è²} { \c{tablea}mÌ¨\c{tableb} \cB\{ \c{avfont}ğ¬©\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è³} { \c{tablea}áº\c{tableb} \cB\{ \c{avfont}ğ¬ª\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è´} { \c{tablea}y\c{tableb} \cB\{ \c{avfont}ğ¬«\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {èµ} { \c{tablea}v\c{tableb} \cB\{ \c{avfont}ğ¬¬\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¶} { \c{tablea}r\c{tableb} \cB\{ \c{avfont}ğ¬­\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è·} { \c{tablea}l\c{tableb} \cB\{ \c{avfont}ğ¬®\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¸} { \c{tablea}s\c{tableb} \cB\{ \c{avfont}ğ¬¯\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¹} { \c{tablea}z\c{tableb} \cB\{ \c{avfont}ğ¬°\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {èº} { \c{tablea}Å¡\c{tableb} \cB\{ \c{avfont}ğ¬±\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è»} { \c{tablea}Å¾\c{tableb} \cB\{ \c{avfont}ğ¬²\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¼} { \c{tablea}Å¡Ì\c{tableb} \cB\{ \c{avfont}ğ¬³\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è½} { \c{tablea}á¹£ÌŒ\c{tableb} \cB\{ \c{avfont}ğ¬´\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¾} { \c{tablea}h\c{tableb} \cB\{ \c{avfont}ğ¬µ\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è¿} { \c{tablea}'\c{tableb} \cB\{ \c{avfont}ğ¬¹\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è€} { \c{tablea}p1\c{tableb} \cB\{ \c{avfont}ğ¬º\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è} { \c{tablea}p2\c{tableb} \cB\{ \c{avfont}ğ¬»\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è‚} { \c{tablea}p3\c{tableb} \cB\{ \c{avfont}ğ¬¼\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {èƒ} { \c{tablea}p4\c{tableb} \cB\{ \c{avfont}ğ¬½\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è„} { \c{tablea}p5\c{tableb} \cB\{ \c{avfont}ğ¬¾\cE\} \c{tablec} } \l_myy_tl
\regex_replace_all:nnN {è…} { \c{tablea}p6\c{tableb} \cB\{ \c{avfont}ğ¬¿\cE\} \c{tablec} } \l_myy_tl
}


\newcommand\doavword{%
\doavtransts
\regex_replace_all:nnN { \. } {  } \l_myts_tl
 \tl_use:N \l_myts_tl  \ ( 

				\exp_args:No 
										\avtranstsst
										{ \l_myb_tl }
				 )
}


\newcommand\doavwordrev{%
%\doavtransts
\exp_args:No \avruby { \l_myts_tl }
%\regex_replace_all:nnN { \. } {  } \l_myts_tl
% \tl_use:N \l_myts_tl  
 $\leftarrow$
 \ ( 

				\exp_args:No 
										\avtranstsst
										{ \l_myb_tl }
				 )
}



\newcommand\doavgloss[1]{%
\doavtransts
\regex_replace_all:nnN { \. } {  } \l_myts_tl
\tl_use:N \l_myts_tl  \ ( 

				\exp_args:No 
										\avtranstsst
										{ \l_myb_tl }
			  , \ `#1'
				 )
}

\newcommand\doavglossrev[1]{%
\exp_args:No \avruby { \l_myts_tl }
%\doavtranstsrev
%\regex_replace_all:nnN { \. } {  } \l_myts_tl
%\tl_use:N \l_myts_tl 
 \ ( 

				\exp_args:No 
										\avtranstsst
										{ \l_myb_tl }
			  , \ `#1'
				 )
}









\NewDocumentCommand { \avuc } { m } {	\avtransuc {#1} }
\NewDocumentCommand { \avtransuc } { m } {%
\tl_set:Nn \l_myuc_tl { #1 }
 \doavtransuc 
 \transrev { \tl_use:N \l_myuc_tl }
}


\NewDocumentCommand { \avun } { m } {	\avtransun {#1} }
\NewDocumentCommand { \avtransun } { m } {%
\tl_set:Nn \l_myun_tl { #1 }
 \doavtransun 
 \exp_args:No 
										\transrev
										{ \l_myun_tl }
}

\NewDocumentCommand { \avts } { m } {	\avtransts {#1} }
\NewDocumentCommand { \avtransts } { m } {%
\tl_set:Nn \l_myts_tl { #1 }
 \doavtransts 
  \transrev { \tl_use:N \l_myts_tl  }
}


\NewDocumentCommand { \avst } { m } {	\avtranstsst {#1} }
\NewDocumentCommand { \avtranstsst } { m } {%
\tl_set:Nn \l_myst_tl { #1 }
 \doavtranstsst 
  \transrev { \tl_use:N \l_myst_tl  }
}

\NewDocumentCommand { \avruby } { m } {%
\tl_set:Nn \l_myy_tl { #1 }
%  \transrevonly { \tl_use:N \l_myy_tl  }
%  \tl_set:NN \l_myy_tl \l_myrev_tl
 \doavtranstsruby 
  \tl_use:N \l_myy_tl 
}

\NewDocumentCommand { \avw } { m } {%
\tl_set:Nn \l_myts_tl { #1 }
\tl_set:Nn \l_myb_tl { #1 }
 \doavword 
}

\NewDocumentCommand { \avwr } { m } {%
\tl_set:Nn \l_myts_tl { #1 }
\tl_set:Nn \l_myb_tl { #1 }
 \doavwordrev 
}


\NewDocumentCommand { \avgloss } { m m } {%
\tl_set:Nn \l_myts_tl { #1 }
\tl_set:Nn \l_myb_tl { #1 }
 \doavgloss {#2}
}

\NewDocumentCommand { \avglossr } { m m } {%
\tl_set:Nn \l_myts_tl { #1 }
\tl_set:Nn \l_myb_tl { #1 }
 \doavglossrev {#2}
}










%---- Environments
\NewDocumentEnvironment{avtransuce}{ +b } 
{
  \tl_set:Nn \l_myuc_tl { #1 }
	\doavtransuc
	\transrev { \tl_use:N \l_myuc_tl  }
}
{ }

\NewDocumentEnvironment{avtransune}{ +b } 
{
  \tl_set:Nn \l_myun_tl { #1 }
	\doavtransun
  \transrev { \tl_use:N \l_myun_tl  }
}
{ }

\NewDocumentEnvironment{avtranstse}{ +b } 
{
  \tl_set:Nn \l_myts_tl { #1 }
	\doavtransts
  \transrev { \tl_use:N \l_myts_tl }
}
{ }


\NewDocumentEnvironment{avtranstsste}{ +b } 
{
%  \tl_set:Nn \l_myug_tl { #1 }
	\doavtranstsst {#1}
%{ \ugfont \tl_use:N \l_myug_tl }
}
{ }


\NewDocumentEnvironment{avrubye}{ +b } 
{
%  \tl_set:Nn \l_myug_tl { #1 }
	\doavtranstsrubye {#1}
%{ \ugfont \tl_use:N \l_myug_tl }
}
{ }



\NewDocumentEnvironment{avtableture}{ +b } 
{
	\begin{quotation}
%	{\raggedright
%	\begin{tabular}{|l|}
%	\hline
%	\rowcolor{blue!5}
	\begin{avtranstse}
	#1
	\end{avtranstse} 			
%					\\
%	\rowcolor{red!5}
\par

\bigskip
	\begin{avtranstsste}
		#1
		\end{avtranstsste} 
%					\\
%	\hline
%	\end{tabular}
%		}
	\end{quotation}
}
{ }





%\RequirePackage{bidi}
\NewDocumentEnvironment{avestan}{ +b } 
{
	\begingroup
%%	\begin{otherlanguage}{hebrew}%babel
% \begin{RTL} %bidi command
	\pardir TRT \textdir TRT% kuatex
  \tl_set:Nn \l_myts_tl { #1 }
	\doavtransts
  \tl_use:N \l_myts_tl 
	\endgroup
% \end{RTL}%bidi command
%%	\end{otherlanguage}%babel
}
{ }



\ExplSyntaxOff




% Lists ====================================

\newcommand\avshowplainlistuc{%
%\subsection{List of Unicode codepoints}\label{sec:listavuc}
\noindent U+10B00 $\mapsto$ {\avfont ğ¬€}\par
\noindent U+10B01 $\mapsto$ {\avfont ğ¬}\par
\noindent U+10B02 $\mapsto$ {\avfont ğ¬‚}\par
\noindent U+10B03 $\mapsto$ {\avfont ğ¬ƒ}\par
\noindent U+10B04 $\mapsto$ {\avfont ğ¬„}\par
\noindent U+10B05 $\mapsto$ {\avfont ğ¬…}\par
\noindent U+10B06 $\mapsto$ {\avfont ğ¬†}\par
\noindent U+10B07 $\mapsto$ {\avfont ğ¬‡}\par
\noindent U+10B08 $\mapsto$ {\avfont ğ¬ˆ}\par
\noindent U+10B09 $\mapsto$ {\avfont ğ¬‰}\par
\noindent U+10B0A $\mapsto$ {\avfont ğ¬Š}\par
\noindent U+10B0B $\mapsto$ {\avfont ğ¬‹}\par
\noindent U+10B0C $\mapsto$ {\avfont ğ¬Œ}\par
\noindent U+10B0D $\mapsto$ {\avfont ğ¬}\par
\noindent U+10B0E $\mapsto$ {\avfont ğ¬}\par
\noindent U+10B0F $\mapsto$ {\avfont ğ¬}\par
\noindent U+10B10 $\mapsto$ {\avfont ğ¬}\par
\noindent U+10B11 $\mapsto$ {\avfont ğ¬‘}\par
\noindent U+10B12 $\mapsto$ {\avfont ğ¬’}\par
\noindent U+10B13 $\mapsto$ {\avfont ğ¬“}\par
\noindent U+10B14 $\mapsto$ {\avfont ğ¬”}\par
\noindent U+10B15 $\mapsto$ {\avfont ğ¬•}\par
\noindent U+10B16 $\mapsto$ {\avfont ğ¬–}\par
\noindent U+10B17 $\mapsto$ {\avfont ğ¬—}\par
\noindent U+10B18 $\mapsto$ {\avfont ğ¬˜}\par
\noindent U+10B19 $\mapsto$ {\avfont ğ¬™}\par
\noindent U+10B1A $\mapsto$ {\avfont ğ¬š}\par
\noindent U+10B1B $\mapsto$ {\avfont ğ¬›}\par
\noindent U+10B1C $\mapsto$ {\avfont ğ¬œ}\par
\noindent U+10B1D $\mapsto$ {\avfont ğ¬}\par
\noindent U+10B1E $\mapsto$ {\avfont ğ¬}\par
\noindent U+10B1F $\mapsto$ {\avfont ğ¬Ÿ}\par
\noindent U+10B20 $\mapsto$ {\avfont ğ¬ }\par
\noindent U+10B21 $\mapsto$ {\avfont ğ¬¡}\par
\noindent U+10B22 $\mapsto$ {\avfont ğ¬¢}\par
\noindent U+10B23 $\mapsto$ {\avfont ğ¬£}\par
\noindent U+10B24 $\mapsto$ {\avfont ğ¬¤}\par
\noindent U+10B25 $\mapsto$ {\avfont ğ¬¥}\par
\noindent U+10B26 $\mapsto$ {\avfont ğ¬¦}\par
\noindent U+10B27 $\mapsto$ {\avfont ğ¬§}\par
\noindent U+10B28 $\mapsto$ {\avfont ğ¬¨}\par
\noindent U+10B29 $\mapsto$ {\avfont ğ¬©}\par
\noindent U+10B2A $\mapsto$ {\avfont ğ¬ª}\par
\noindent U+10B2B $\mapsto$ {\avfont ğ¬«}\par
\noindent U+10B2C $\mapsto$ {\avfont ğ¬¬}\par
\noindent U+10B2D $\mapsto$ {\avfont ğ¬­}\par
\noindent U+10B2E $\mapsto$ {\avfont ğ¬®}\par
\noindent U+10B2F $\mapsto$ {\avfont ğ¬¯}\par
\noindent U+10B30 $\mapsto$ {\avfont ğ¬°}\par
\noindent U+10B31 $\mapsto$ {\avfont ğ¬±}\par
\noindent U+10B32 $\mapsto$ {\avfont ğ¬²}\par
\noindent U+10B33 $\mapsto$ {\avfont ğ¬³}\par
\noindent U+10B34 $\mapsto$ {\avfont ğ¬´}\par
\noindent U+10B35 $\mapsto$ {\avfont ğ¬µ}\par
\noindent U+10B39 $\mapsto$ {\avfont ğ¬¹}\par
\noindent U+10B3A $\mapsto$ {\avfont ğ¬º}\par
\noindent U+10B3B $\mapsto$ {\avfont ğ¬»}\par
\noindent U+10B3C $\mapsto$ {\avfont ğ¬¼}\par
\noindent U+10B3D $\mapsto$ {\avfont ğ¬½}\par
\noindent U+10B3E $\mapsto$ {\avfont ğ¬¾}\par
\noindent U+10B3F $\mapsto$ {\avfont ğ¬¿}\par
}



%-----   List of Unicode names
\newcommand\avshowplainlistun{%
%\subsection{List of Unicode names}\label{sec:listavun}
\noindent a $\mapsto$ {\avfont ğ¬€}\par
\noindent aa $\mapsto$ {\avfont ğ¬}\par
\noindent ao $\mapsto$ {\avfont ğ¬‚}\par
\noindent aao $\mapsto$ {\avfont ğ¬ƒ}\par
\noindent an $\mapsto$ {\avfont ğ¬„}\par
\noindent aan $\mapsto$ {\avfont ğ¬…}\par
\noindent ae $\mapsto$ {\avfont ğ¬†}\par
\noindent aee $\mapsto$ {\avfont ğ¬‡}\par
\noindent e $\mapsto$ {\avfont ğ¬ˆ}\par
\noindent ee $\mapsto$ {\avfont ğ¬‰}\par
\noindent o $\mapsto$ {\avfont ğ¬Š}\par
\noindent oo $\mapsto$ {\avfont ğ¬‹}\par
\noindent i $\mapsto$ {\avfont ğ¬Œ}\par
\noindent ii $\mapsto$ {\avfont ğ¬}\par
\noindent u $\mapsto$ {\avfont ğ¬}\par
\noindent uu $\mapsto$ {\avfont ğ¬}\par
\noindent ke $\mapsto$ {\avfont ğ¬}\par
\noindent xe $\mapsto$ {\avfont ğ¬‘}\par
\noindent xye $\mapsto$ {\avfont ğ¬’}\par
\noindent xve $\mapsto$ {\avfont ğ¬“}\par
\noindent ge $\mapsto$ {\avfont ğ¬”}\par
\noindent gge $\mapsto$ {\avfont ğ¬•}\par
\noindent ghe $\mapsto$ {\avfont ğ¬–}\par
\noindent ce $\mapsto$ {\avfont ğ¬—}\par
\noindent je $\mapsto$ {\avfont ğ¬˜}\par
\noindent te $\mapsto$ {\avfont ğ¬™}\par
\noindent the $\mapsto$ {\avfont ğ¬š}\par
\noindent de $\mapsto$ {\avfont ğ¬›}\par
\noindent dhe $\mapsto$ {\avfont ğ¬œ}\par
\noindent tte $\mapsto$ {\avfont ğ¬}\par
\noindent pe $\mapsto$ {\avfont ğ¬}\par
\noindent fe $\mapsto$ {\avfont ğ¬Ÿ}\par
\noindent be $\mapsto$ {\avfont ğ¬ }\par
\noindent bhe $\mapsto$ {\avfont ğ¬¡}\par
\noindent nge $\mapsto$ {\avfont ğ¬¢}\par
\noindent ngye $\mapsto$ {\avfont ğ¬£}\par
\noindent ngve $\mapsto$ {\avfont ğ¬¤}\par
\noindent ne $\mapsto$ {\avfont ğ¬¥}\par
\noindent nye $\mapsto$ {\avfont ğ¬¦}\par
\noindent nne $\mapsto$ {\avfont ğ¬§}\par
\noindent me $\mapsto$ {\avfont ğ¬¨}\par
\noindent hme $\mapsto$ {\avfont ğ¬©}\par
\noindent yye $\mapsto$ {\avfont ğ¬ª}\par
\noindent ye $\mapsto$ {\avfont ğ¬«}\par
\noindent ve $\mapsto$ {\avfont ğ¬¬}\par
\noindent re $\mapsto$ {\avfont ğ¬­}\par
\noindent le $\mapsto$ {\avfont ğ¬®}\par
\noindent se $\mapsto$ {\avfont ğ¬¯}\par
\noindent ze $\mapsto$ {\avfont ğ¬°}\par
\noindent she $\mapsto$ {\avfont ğ¬±}\par
\noindent zhe $\mapsto$ {\avfont ğ¬²}\par
\noindent shye $\mapsto$ {\avfont ğ¬³}\par
\noindent sshe $\mapsto$ {\avfont ğ¬´}\par
\noindent he $\mapsto$ {\avfont ğ¬µ}\par
\noindent abbreviationmark $\mapsto$ {\avfont ğ¬¹}\par
\noindent p1 $\mapsto$ {\avfont ğ¬º}\par
\noindent p2 $\mapsto$ {\avfont ğ¬»}\par
\noindent p3 $\mapsto$ {\avfont ğ¬¼}\par
\noindent p4 $\mapsto$ {\avfont ğ¬½}\par
\noindent p5 $\mapsto$ {\avfont ğ¬¾}\par
\noindent p6 $\mapsto$ {\avfont ğ¬¿}\par
}


%-----   List of Typing shortcuts
\newcommand\avshowplainlistts{%
%\subsection{List of Typing shortcuts}\label{sec:listavts}
\noindent a $\mapsto$ {\avfont ğ¬€}\par
\noindent aa $\mapsto$ {\avfont ğ¬}\par
\noindent ah $\mapsto$ {\avfont ğ¬‚}\par
\noindent ahh $\mapsto$ {\avfont ğ¬ƒ}\par
\noindent au $\mapsto$ {\avfont ğ¬„}\par
\noindent auu $\mapsto$ {\avfont ğ¬…}\par
\noindent eh $\mapsto$ {\avfont ğ¬†}\par
\noindent ehh $\mapsto$ {\avfont ğ¬‡}\par
\noindent e $\mapsto$ {\avfont ğ¬ˆ}\par
\noindent ee $\mapsto$ {\avfont ğ¬‰}\par
\noindent o $\mapsto$ {\avfont ğ¬Š}\par
\noindent oo $\mapsto$ {\avfont ğ¬‹}\par
\noindent i $\mapsto$ {\avfont ğ¬Œ}\par
\noindent ii $\mapsto$ {\avfont ğ¬}\par
\noindent u $\mapsto$ {\avfont ğ¬}\par
\noindent uu $\mapsto$ {\avfont ğ¬}\par
\noindent k $\mapsto$ {\avfont ğ¬}\par
\noindent x $\mapsto$ {\avfont ğ¬‘}\par
\noindent xx $\mapsto$ {\avfont ğ¬’}\par
\noindent xv $\mapsto$ {\avfont ğ¬“}\par
\noindent g $\mapsto$ {\avfont ğ¬”}\par
\noindent gg $\mapsto$ {\avfont ğ¬•}\par
\noindent gh $\mapsto$ {\avfont ğ¬–}\par
\noindent c $\mapsto$ {\avfont ğ¬—}\par
\noindent j $\mapsto$ {\avfont ğ¬˜}\par
\noindent t $\mapsto$ {\avfont ğ¬™}\par
\noindent th $\mapsto$ {\avfont ğ¬š}\par
\noindent d $\mapsto$ {\avfont ğ¬›}\par
\noindent dh $\mapsto$ {\avfont ğ¬œ}\par
\noindent tt $\mapsto$ {\avfont ğ¬}\par
\noindent p $\mapsto$ {\avfont ğ¬}\par
\noindent f $\mapsto$ {\avfont ğ¬Ÿ}\par
\noindent b $\mapsto$ {\avfont ğ¬ }\par
\noindent w $\mapsto$ {\avfont ğ¬¡}\par
\noindent ng $\mapsto$ {\avfont ğ¬¢}\par
\noindent ngj $\mapsto$ {\avfont ğ¬£}\par
\noindent ngw $\mapsto$ {\avfont ğ¬¤}\par
\noindent n $\mapsto$ {\avfont ğ¬¥}\par
\noindent ny $\mapsto$ {\avfont ğ¬¦}\par
\noindent nny $\mapsto$ {\avfont ğ¬§}\par
\noindent m $\mapsto$ {\avfont ğ¬¨}\par
\noindent mh $\mapsto$ {\avfont ğ¬©}\par
\noindent yy $\mapsto$ {\avfont ğ¬ª}\par
\noindent y $\mapsto$ {\avfont ğ¬«}\par
\noindent v $\mapsto$ {\avfont ğ¬¬}\par
\noindent r $\mapsto$ {\avfont ğ¬­}\par
\noindent l $\mapsto$ {\avfont ğ¬®}\par
\noindent s $\mapsto$ {\avfont ğ¬¯}\par
\noindent z $\mapsto$ {\avfont ğ¬°}\par
\noindent sh $\mapsto$ {\avfont ğ¬±}\par
\noindent zh $\mapsto$ {\avfont ğ¬²}\par
\noindent ssh $\mapsto$ {\avfont ğ¬³}\par
\noindent ss $\mapsto$ {\avfont ğ¬´}\par
\noindent h $\mapsto$ {\avfont ğ¬µ}\par
\noindent ' $\mapsto$ {\avfont ğ¬¹}\par
\noindent p1 $\mapsto$ {\avfont ğ¬º}\par
\noindent p2 $\mapsto$ {\avfont ğ¬»}\par
\noindent p3 $\mapsto$ {\avfont ğ¬¼}\par
\noindent p4 $\mapsto$ {\avfont ğ¬½}\par
\noindent p5 $\mapsto$ {\avfont ğ¬¾}\par
\noindent p6 $\mapsto$ {\avfont ğ¬¿}\par
}


%-----   List of Standard Transliterations
\newcommand\avshowplainlistst{%
%\subsection{List of Standard Transliterations}\label{sec:listavst}
\noindent a $\mapsto$ a\par
\noindent aa $\mapsto$ Ä\par
\noindent ah $\mapsto$ Ã¥\par
\noindent ahh $\mapsto$ ÄÌŠ\par
\noindent au $\mapsto$ Ä…\par
\noindent auu $\mapsto$ Ä…Ì‡\par
\noindent eh $\mapsto$ É™\par
\noindent ehh $\mapsto$ É™Ì„\par
\noindent e $\mapsto$ e\par
\noindent ee $\mapsto$ Ä“\par
\noindent o $\mapsto$ o\par
\noindent oo $\mapsto$ Å\par
\noindent i $\mapsto$ i\par
\noindent ii $\mapsto$ Ä«\par
\noindent u $\mapsto$ u\par
\noindent uu $\mapsto$ Å«\par
\noindent k $\mapsto$ k\par
\noindent x $\mapsto$ x\par
\noindent xx $\mapsto$ xÌ\par
\noindent xv $\mapsto$ xáµ›\par
\noindent g $\mapsto$ g\par
\noindent gg $\mapsto$ Ä¡\par
\noindent gh $\mapsto$ Î³\par
\noindent c $\mapsto$ c\par
\noindent j $\mapsto$ j\par
\noindent t $\mapsto$ t\par
\noindent th $\mapsto$ Ï‘\par
\noindent d $\mapsto$ d\par
\noindent dh $\mapsto$ Î´\par
\noindent tt $\mapsto$ tÌ°\par
\noindent p $\mapsto$ p\par
\noindent f $\mapsto$ f\par
\noindent b $\mapsto$ b\par
\noindent w $\mapsto$ Î²\par
\noindent ng $\mapsto$ Å‹\par
\noindent ngj $\mapsto$ Å‹Ì\par
\noindent ngw $\mapsto$ Å‹áµ›\par
\noindent n $\mapsto$ n\par
\noindent ny $\mapsto$ Å„\par
\noindent nny $\mapsto$ á¹‡\par
\noindent m $\mapsto$ m\par
\noindent mh $\mapsto$ mÌ¨\par
\noindent yy $\mapsto$ áº\par
\noindent y $\mapsto$ y\par
\noindent v $\mapsto$ v\par
\noindent r $\mapsto$ r\par
\noindent l $\mapsto$ l\par
\noindent s $\mapsto$ s\par
\noindent z $\mapsto$ z\par
\noindent sh $\mapsto$ Å¡\par
\noindent zh $\mapsto$ Å¾\par
\noindent ssh $\mapsto$ Å¡Ì\par
\noindent ss $\mapsto$ á¹£ÌŒ\par
\noindent h $\mapsto$ h\par
\noindent ' $\mapsto$ '\par
\noindent p1 $\mapsto$ p1\par
\noindent p2 $\mapsto$ p2\par
\noindent p3 $\mapsto$ p3\par
\noindent p4 $\mapsto$ p4\par
\noindent p5 $\mapsto$ p5\par
\noindent p6 $\mapsto$ p6\par
}





\newcommand\ava{\symbol{68352}}
\newcommand\avaa{\symbol{68353}}
\newcommand\avao{\symbol{68354}}
\newcommand\avaao{\symbol{68355}}
\newcommand\avan{\symbol{68356}}
\newcommand\avaan{\symbol{68357}}
\newcommand\avae{\symbol{68358}}
\newcommand\avaee{\symbol{68359}}
\newcommand\ave{\symbol{68360}}
\newcommand\avee{\symbol{68361}}
\newcommand\avo{\symbol{68362}}
\newcommand\avoo{\symbol{68363}}
\newcommand\avi{\symbol{68364}}
\newcommand\avii{\symbol{68365}}
\newcommand\avu{\symbol{68366}}
\newcommand\avuu{\symbol{68367}}
\newcommand\avke{\symbol{68368}}
\newcommand\avxe{\symbol{68369}}
\newcommand\avxye{\symbol{68370}}
\newcommand\avxve{\symbol{68371}}
\newcommand\avge{\symbol{68372}}
\newcommand\avgge{\symbol{68373}}
\newcommand\avghe{\symbol{68374}}
\newcommand\avce{\symbol{68375}}
\newcommand\avje{\symbol{68376}}
\newcommand\avte{\symbol{68377}}
\newcommand\avthe{\symbol{68378}}
\newcommand\avde{\symbol{68379}}
\newcommand\avdhe{\symbol{68380}}
\newcommand\avtte{\symbol{68381}}
\newcommand\avpe{\symbol{68382}}
\newcommand\avfe{\symbol{68383}}
\newcommand\avbe{\symbol{68384}}
\newcommand\avbhe{\symbol{68385}}
\newcommand\avnge{\symbol{68386}}
\newcommand\avngye{\symbol{68387}}
\newcommand\avngve{\symbol{68388}}
\newcommand\avne{\symbol{68389}}
\newcommand\avnye{\symbol{68390}}
\newcommand\avnne{\symbol{68391}}
\newcommand\avme{\symbol{68392}}
\newcommand\avhme{\symbol{68393}}
\newcommand\avyye{\symbol{68394}}
\newcommand\avye{\symbol{68395}}
\newcommand\avve{\symbol{68396}}
\newcommand\avre{\symbol{68397}}
\newcommand\avle{\symbol{68398}}
\newcommand\avse{\symbol{68399}}
\newcommand\avze{\symbol{68400}}
\newcommand\avshe{\symbol{68401}}
\newcommand\avzhe{\symbol{68402}}
\newcommand\avshye{\symbol{68403}}
\newcommand\avsshe{\symbol{68404}}
\newcommand\avhe{\symbol{68405}}
\newcommand\avabbreviationmark{\symbol{68409}}
\newcommand\avpi{\symbol{68410}}
\newcommand\avpii{\symbol{68411}}
\newcommand\avpiii{\symbol{68412}}
\newcommand\avpiv{\symbol{68413}}
\newcommand\avpv{\symbol{68414}}
\newcommand\avpvi{\symbol{68415}}

